---
foam_template:
  name: Blog Docusaurus Template
  description: Creates Docusaurus blog/slip
  filepath: blog/wiki-assembly.mdx # See using [Variable transforms](https://code.visualstudio.com/docs/editor/userdefinedsnippets#_variable-transforms )
authors:
  - frank
tags:
  - Wiki Assembly
description: Wiki Assembly
keywords:
  - Wiki Assembly
image: https://i.imgur.com/mErPwqL.png
date: 2023-11-22
draft: false
enableComments: true # for Gisqus
---

# Wiki Assembly

Why `Assembly` language is critical elementary foundation to the whole programming language from the lower-level language `C`, `Go`, `Rust`?

1. The most low-level language that is closely tied to the hardware such as `CPU`.
   1. `Assembly` language is written to follow the `CPU` execution logic directly.
2. `Assembly` language facilities a deeper understanding of computer architecture such as how the `CPU` functions.


<!--truncate-->

```asm title="print.asm"
; print.asm
; nasm -f elf64 print.asm && ld print.o && ./a.out ; echo $?
; objdump -d a.out
section .data
message db, "Welcome,   to, Segmentation, Faults!, "

section .text

global _start

_printMessage:
    mov rax, 4       ; System call number for sys_write
    mov rbx, 1       ; File descriptor 1 is stdout
    mov rcx, message ; Pointer to the message string
    mov rdx, 32      ; Length of the message
    int 0x80         ; Call kernel

    ret ; Return from the function

_exit:
    mov rax, 1 ; System call number for sys_exit
    mov rbx, 0 ; Exit code 0
    int 0x80   ; Call kernel

_start:
    call _printMessage ; Call the print message function
    mov  rax, 1        ; System call number for sys_exit
    mov  rbx, 1        ; Exit code 0
    int  0x80          ; Call kernel
```

```asm title="sum.asm"
; sum.asm
; nasm -f elf64 sum.asm && ld sum.o && ./a.out ; echo $?
; objdump -d a.out
section .text
global _start

; Function to calculate the sum of two integers
sum:
    mov rax, rdi   ; Move the first argument (a) to rax
    add rax, rsi   ; Add the second argument (b) to rax
    ret            ; Return with the result in rax

_start:
    ; Example usage of the sum function
    mov rdi, 5     ; First argument: a = 5
    mov rsi, 7     ; Second argument: b = 7

    call sum       ; Call the sum function

    ; The result is now in rax
    ; It can be used or printed, depending on the context
    mov rdi, rax   ; Exit code 0

    ; Exit the program
    mov rax, 60    ; System call number for sys_exit
    syscall        ; Make the system call
```

## Assembly Instructions

## Assembly Opcodes

[Intel x86 Assembler Instruction Set Opcode Table](http://sparksandflames.com/files/x86InstructionChart.html)

Assembly instructions are human readable representation of the assembly `Opcode` which hex codes.

## Assembly Oprands

### Register Operands
### Memory Operands
### Immediate Operands

## Bootstrap a Compiler

1. Write a compiler C1 for language X in language Y
2. Use the compiler C1 to write compiler C2 for language X in language X
3. Now C2 is a fully self hosting environment.

[Compilers: Principles, Techniques, and Tools - Wikipedia](http://en.wikipedia.org/wiki/Compilers:_Principles,_Techniques,_and_Tools)

1. Bootstrapping initial compiler `C1`:
   1. A small and simple compiler is created manually in machine code or written in a lower-level language like `assembly` language.
   2. [Option*] Translate the `assembly` language into machine code manually if it's not written in machine code.
   3. The initial compiler is just capable enough to understand a subset of the target language `C` it is supposed to compile.
2. Use the initial compiler `C1` to compile the compiler `C2` written in language `C` while the `C2` is also supposed to compile language `C`.
3. Now compiler `C2` a fully self-compilation.


## Resources

https://gist.github.com/mikesmullin/6259449

https://cs.lmu.edu/~ray/notes/nasmtasutorial/

https://cs.brown.edu/courses/cs033/docs/guides/x64_cheatsheet.pdf

http://6.s081.scripts.mit.edu/sp18/x86-64-architecture-guide.html

https://cs61.seas.harvard.edu/site/2018/Asm1/

https://web.stanford.edu/class/cs107/guide/x86-64.html

https://www.cs.virginia.edu/~evans/cs216/guides/x86.html

https://www.cs.uaf.edu/2016/fall/cs301/lecture/09_28_machinecode.html

https://p403n1x87.github.io/getting-started-with-x86-64-assembly-on-linux.html

https://flint.cs.yale.edu/cs421/papers/x86-asm/asm.html

https://nickdesaulniers.github.io/blog/2014/04/18/lets-write-some-x86-64/

https://pacman128.github.io/static/pcasm-book.pdf