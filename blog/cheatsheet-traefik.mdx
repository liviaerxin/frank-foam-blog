---
authors:
  - frank
tags:
  - Cheatsheet Traefik
description: Cheatsheet Traefik
keywords:
  - Cheatsheet Traefik
image: https://i.imgur.com/mErPwqL.png
date: 2024-01-17
draft: false
enableComments: true # for Gisqus
---

# Traefik Cheat Sheet

Here are quick references for using `Traefik`.

I use `Traefik` in my docker compose project more frequently than using `Nginx`, as it has such advantages:
- Simply to use and fast to spin up
  - Configuration relies on platform syntax(like `Docker labels` or `Kubernetes annotations`), while `Nginx` uses its own syntax and directives.
  - Configuration can just sit in `docker-compose.yml`, but `Nginx` always uses a dedicate configuration file(`/etc/nginx/nginx.conf`).
- Dynamic configuration:
  - Changes to the configuration require a restart of the `Nginx` process
  - Changes to the configuration require a restart of its corresponding service, not the `Traefik` process

<!--truncate-->

## Redirect root path `/` to a subpath

The goal is to redirect root path `/` to sub path `/mtr` that's an ingress for a web service:

- `http://127.0.0.1` -> `http://127.0.0.1/mtr`
- `http://127.0.0.1` -> `http://127.0.0.1/mtr`
- `https://127.0.0.1/something` -> no redirect

It works for **Traefik 2.0**

```yml
services:
  traefik:
    image: traefik:v2.10
    command:
      - --api.insecure=true
      - --providers.docker=true
      - --providers.docker.exposedbydefault=false
      - --entrypoints.web.address=:80
    ports:
      - 80:80
      - 8080:8080 # Web UI Port
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
    labels:
      - traefik.enable=true
      - traefik.http.routers.domain.entrypoints=web
      - traefik.http.routers.domain.rule=Path(`/`)
      - traefik.http.routers.domain.service=noop@internal
      - traefik.http.routers.domain.middlewares=to-web-frontend@docker
      - traefik.http.middlewares.to-web-frontend.redirectregex.permanent=true
      - traefik.http.middlewares.to-web-frontend.redirectregex.regex=^http://([^/]+)/?$ # http://127.0.0.1
      - traefik.http.middlewares.to-web-frontend.redirectregex.replacement=http://$${1}/mtr # http://127.0.0.1/mtr # http://127.0.0.1 -> http://127.0.0.1/mtr

  web-frontend:
    image:  traefik/whoami:v2.10
    labels:
      - traefik.enable=true
      - traefik.http.routers.web-frontend.entrypoints=web
      - traefik.http.routers.web-frontend.rule=PathPrefix(`/mtr`) # match `http://127.0.0.1/mtr` -> ingress `/mtr`
```

## Resources


[URL Redirect abc.com to xyz.com - Traefik v2 (latest) - Traefik Labs Community Forum](https://community.traefik.io/t/url-redirect-abc-com-to-xyz-com/8084)

[Traefik redirect / (root) to sub path with Docker labels Â· GitHub](https://gist.github.com/kekru/d088be6a3fa844089ae62d80c077bb38)