"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8620],{815:(t,n,e)=>{e.r(n),e.d(n,{assets:()=>u,contentTitle:()=>l,default:()=>y,frontMatter:()=>c,metadata:()=>r,toc:()=>d});var o=e(7462),a=(e(7294),e(3905)),i=e(614);const s='# main.py\nfrom fastapi import FastAPI\nimport asyncio\n\napp = FastAPI()\nlock = asyncio.Lock()\n\ncounter = 0\n\n@app.post("/limit")\nasync def func():\n    global counter\n    async with lock:\n        print("Hello")\n        counter = counter + 1\n        await asyncio.sleep(2)\n        print("bye")\n        await asyncio.sleep(2)\n        return {"counter": counter}\n\n\n"""\nMake 2 requests at a time, output from server:\n\nINFO:     127.0.0.1:60228 - "POST /limit HTTP/1.1" 200 OK\nHello\nbye\nINFO:     127.0.0.1:51010 - "POST /limit HTTP/1.1" 200 OK\nHello\nbye\nINFO:     127.0.0.1:51022 - "POST /limit HTTP/1.1" 200 OK\n\nRequest 1:\n\n\u276f curl -X \'POST\' \\\n  \'http://127.0.0.1:8000/limit\' \\\n  -H \'accept: application/json\' \\\n  -d \'\'\n{"counter":1}%\n\nRequest 2:\n\n\u276f curl -X \'POST\' \\\n  \'http://127.0.0.1:8000/limit\' \\\n  -H \'accept: application/json\' \\\n  -d \'\'\n{"counter":2}%\n"""\n',p='# main.py\nfrom fastapi import FastAPI\nimport asyncio\n\napp = FastAPI()\nlock = asyncio.Lock()\n\ncounter = 0\n\n\n@app.post("/limit")\nasync def func():\n    global counter\n    print("Hello")\n    counter = counter + 1\n    await asyncio.sleep(2)\n    print("bye")\n    await asyncio.sleep(2)\n    return {"counter": counter}\n\n\n"""\nMake 2 requests at a time, output from server:\n\nHello\nHello\nbye\nbye\nINFO:     127.0.0.1:45160 - "POST /limit HTTP/1.1" 200 OK\nINFO:     127.0.0.1:45172 - "POST /limit HTTP/1.1" 200 OK\n\nRequest 1:\n\n\u276f curl -X \'POST\' \\\n  \'http://127.0.0.1:8000/limit\' \\\n  -H \'accept: application/json\' \\\n  -d \'\'\n{"counter":2}%\n\nRequest 2:\n\n\u276f curl -X \'POST\' \\\n  \'http://127.0.0.1:8000/limit\' \\\n  -H \'accept: application/json\' \\\n  -d \'\'\n{"counter":2}%\n"""\n',c={foam_template:{name:"Docs Docusaurus Template",description:"Creates Docusaurus docs/slip",filepath:"docs/lock-http-request.md"},sidebar_label:"Lock Http Request",description:"Lock Endpoint Request At A Time",keywords:["limit only one access to endpoint at a time","lock access to endpoint at a time"],image:"https://i.imgur.com/mErPwqL.png",tags:["fastapi","python","http"],last_update:{date:new Date("2023-06-21T00:00:00.000Z"),author:"frank"}},l="Lock Http Request",r={unversionedId:"lock-endpoint-request",id:"lock-endpoint-request",title:"Lock Http Request",description:"Lock Endpoint Request At A Time",source:"@site/../../docs/lock-endpoint-request.mdx",sourceDirName:".",slug:"/lock-endpoint-request",permalink:"/docs/lock-endpoint-request",draft:!1,editUrl:"https://github.com/liviaerxin/liviaerxin.github.io/edit/master/_ssg/docusaurus/../../docs/lock-endpoint-request.mdx",tags:[{label:"fastapi",permalink:"/docs/tags/fastapi"},{label:"python",permalink:"/docs/tags/python"},{label:"http",permalink:"/docs/tags/http"}],version:"current",lastUpdatedBy:"frank",lastUpdatedAt:1687305600,formattedLastUpdatedAt:"Jun 21, 2023",frontMatter:{foam_template:{name:"Docs Docusaurus Template",description:"Creates Docusaurus docs/slip",filepath:"docs/lock-http-request.md"},sidebar_label:"Lock Http Request",description:"Lock Endpoint Request At A Time",keywords:["limit only one access to endpoint at a time","lock access to endpoint at a time"],image:"https://i.imgur.com/mErPwqL.png",tags:["fastapi","python","http"],last_update:{date:"2023-06-21T00:00:00.000Z",author:"frank"}},sidebar:"tutorialSidebar",previous:{title:"Using Foam",permalink:"/docs/"},next:{title:"Your markdown including PlantUML code block",permalink:"/docs/markdown-plantuml"}},u={},d=[],m={toc:d},k="wrapper";function y(t){let{components:n,...e}=t;return(0,a.kt)(k,(0,o.Z)({},m,e,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"lock-http-request"},"Lock Http Request"),(0,a.kt)("p",null,"Limit only one access to an endpoint at a time in ",(0,a.kt)("strong",{parentName:"p"},"FastAPI"),"."),(0,a.kt)(i.Z,{language:"python",title:"../code-snippets/app_request_lock.py",mdxType:"CodeBlock"},s),(0,a.kt)("p",null,"No limitation."),(0,a.kt)(i.Z,{language:"python",title:"../code-snippets/app_request_nolock.py",mdxType:"CodeBlock"},p))}y.isMDXComponent=!0}}]);